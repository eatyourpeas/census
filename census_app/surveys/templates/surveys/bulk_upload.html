{% extends 'base.html' %}
{% block title %}Import Questions - {{ survey.name }}{% endblock %}
{% block content %}
<div class="prose">
  {% include 'components/breadcrumbs.html' with crumb1_label="Survey Dashboard" crumb1_href="/surveys/"|add:survey.slug|add:"/dashboard/" crumb2_label="Import Questions" %}
  <h1 class="inline-flex items-center gap-2">
    {% include "components/icons/document.html" with classes="w-6 h-6" %}
    <span>Import questions: {{ survey.name }}</span>
  </h1>
</div>

{% if error %}
  <div class="alert alert-error my-3">{{ error }}</div>
{% endif %}

<div class="grid md:grid-cols-2 gap-6">
  <div>
    <form method="post">
      {% csrf_token %}
      <label class="label">Markdown</label>
  <textarea class="textarea textarea-bordered w-full min-h-[360px]" name="markdown" placeholder="REPEAT-5
# Patient
Basic info about respondents

## Age
Age in years
(text number)

## Gender
Self-described gender
(mc_single)
- Female
- Male
- Non-binary
- Prefer not to say

> REPEAT
> # Visit
> Details about each visit
>
> ## Date of visit
> (text)

# Satisfaction
About the service

## Overall satisfaction
Rate from 1 to 5
(likert number)
min: 1
max: 5
left: Very poor
right: Excellent

## Recommend to a friend
Likelihood to recommend
(likert categories)
- Very unlikely
- Unlikely
- Neutral
- Likely
- Very likely
" required>{{ markdown|default:example }}</textarea>
      <div class="mt-3">
        <button class="btn btn-primary" type="submit">Import</button>
      </div>
    </form>
  </div>
  <div>
    <h2 class="text-xl font-semibold">Format reference</h2>
    <p>Use markdown with the following structure:</p>
    <ul class="list-disc pl-5">
      <li># Group Title, followed by a line for the group description</li>
      <li>## Question Title, followed by a line for the question description</li>
      <li>(type) on the next line in parentheses</li>
      <li>If the type requires options, list each on a line starting with <code>-</code></li>
      <li>For Likert number scales, add key-value lines: <code>min:</code>, <code>max:</code>, optional <code>left:</code>, <code>right:</code></li>
    </ul>
    <h3 class="mt-4 font-semibold">Supported types</h3>
    <ul class="list-disc pl-5">
      <li>text — free text</li>
      <li>text number — numeric input</li>
      <li>mc_single — multiple choice (single)</li>
      <li>mc_multi — multiple choice (multi)</li>
      <li>dropdown — select menu</li>
      <li>orderable — orderable list</li>
      <li>yesno — yes/no</li>
      <li>image — image choice</li>
      <li>likert categories — categories listed with <code>-</code></li>
      <li>likert number — provide <code>min</code>/<code>max</code> and optional labels</li>
    </ul>
    <h3 class="mt-4 font-semibold">Optional: Collections with REPEAT</h3>
    <p>To mark a group as repeatable, add a line with <strong>REPEAT</strong> (or <strong>REPEAT-5</strong> to cap it) immediately above the group heading.</p>
    <p>To define a child collection nested under a repeatable parent, indent with <code>&gt; </code> and add <strong>REPEAT</strong> above the child group:</p>
    <pre><code>REPEAT-5
# Patient
... group content ...

> REPEAT
> # Visit
> ... child group content ...
    </code></pre>
    <ul class="list-disc pl-5">
      <li><strong>REPEAT</strong> = unlimited repeats. <strong>REPEAT-1</strong> means one allowed.</li>
      <li>Use <code>&gt; </code> before REPEAT and the group heading to indicate one level of nesting.</li>
      <li>Nesting is limited to one level (Parent → Child) by design.</li>
      <li>Groups without REPEAT are normal, non-collection groups.</li>
    </ul>
  </div>
 </div>
{% endblock %}
